var dgg,dataSynchronize,dataSynchronizeLog,monitorConfig;$(function(){initData()});
function initData(){dgg=$("#dataSynchronizeList").datagrid({method:"post",url:baseUrl+"/dataSynchronize/dataSynchronizeList?v="+Math.random(),fit:!0,fitColumns:!0,border:!1,idField:"id",striped:!0,pagination:!0,rownumbers:!0,pageNumber:1,pageSize:20,pageList:[10,20,30,40,50],singleSelect:!1,columns:[[{field:"TREESOFTPRIMARYKEY",checkbox:!0},{field:"id",title:"\u64cd\u4f5c",halign:"center",width:100,sortable:!0,formatter:function(a,b,c){return'<a class="l-btn l-btn-small" href="javascript:viewLog(\''+
b.id+'\')" ><span class="l-btn-left l-btn-icon-left"><span class="l-btn-text" style="line-height: 18px;">\u65e5\u5fd7</span><span class="l-btn-icon icon-search">&nbsp;</span></span></a> <a class="l-btn l-btn-small" href="javascript:editDataSynchronizeOne(\''+b.id+'\')" ><span class="l-btn-left l-btn-icon-left"><span class="l-btn-text" style="line-height: 18px;">\u4fee\u6539</span><span class="l-btn-icon icon-edit">&nbsp;</span></span></a> '}},{field:"name",title:"\u4efb\u52a1\u540d\u79f0",halign:"center",
width:120},{field:"sourceConfig",title:"\u6570\u636e\u6765\u6e90",halign:"center",sortable:!0,width:130},{field:"sourceDataBase",title:"\u6765\u6e90\u5e93\u540d",halign:"center",sortable:!0,width:80},{field:"targetConfig",title:"\u540c\u6b65\u76ee\u6807",halign:"center",sortable:!0,width:100},{field:"targetDataBase",title:"\u76ee\u6807\u5e93\u540d",halign:"center",sortable:!0,width:80},{field:"targetTable",title:"\u76ee\u6807\u8868\u540d",halign:"center",sortable:!0,width:80},{field:"operation",title:"\u6267\u884c\u52a8\u4f5c",
halign:"center",sortable:!0,formatter:function(a,b,c){return"0"==b.operation?"<font >\u65b0\u589e</font>":"1"==b.operation?"<font >\u66f4\u65b0</font>":"2"==b.operation?"<font >\u8986\u76d6</font>":"3"==b.operation?"<font >\u8ffd\u52a0</font>":"4"==b.operation?"<font >\u5220\u9664</font>":""}},{field:"state",title:"\u662f\u5426\u542f\u7528",halign:"center",sortable:!0,formatter:function(a,b,c){return"0"==b.state?'<font color="green">\u542f\u7528</font>':"1"==b.state?'<font color="red">\u505c\u7528</font>':
""}},{field:"status",title:"\u5f53\u524d\u8fd0\u884c\u72b6\u6001",halign:"center",sortable:!0,formatter:function(a,b,c){return"0"==b.status?'<font color="red">\u505c\u6b62</font>':"1"==b.status?'<font color="green">\u8fd0\u884c\u4e2d</font>':"2"==b.status?'<font color="green">\u6210\u529f</font>':"3"==b.status?'<font color="red">\u5f02\u5e38</font>':""}}]],checkOnSelect:!0,selectOnCheck:!0,extEditing:!1,toolbar:"#tb3",autoEditing:!1,singleEditing:!1,onDblClickRow:function(a,b){a=b.id;dataSynchronize=
$("#dlgg").dialog({title:"\u67e5\u770b",width:585,height:450,href:baseUrl+"/dataSynchronize/editDataSynchronizeForm/"+a,maximizable:!0,modal:!0,buttons:[{text:"\u53d6\u6d88",iconCls:"icon-cancel",handler:function(){dataSynchronize.panel("close")}}]})}})}
function addConfigForm(){dataSynchronize=$("#dlgg").dialog({title:" \u65b0\u589e",width:585,height:450,href:baseUrl+"/dataSynchronize/addDataSynchronizeForm",maximizable:!0,modal:!0,buttons:[{text:"\u4fdd\u5b58",iconCls:"icon-ok",handler:function(){addOrUpdateDataSynchronize()}},{text:"\u53d6\u6d88",iconCls:"icon-cancel",handler:function(){dataSynchronize.panel("close")}}]})}
function monitorConfigForm(){monitorConfig=$("#dlgg").dialog({title:"&nbsp;\u9884\u8b66\u914d\u7f6e",width:400,height:370,href:baseUrl+"/monitorConfig/monitorConfigForm?id=1111abc",maximizable:!0,modal:!0,buttons:[{text:"\u4fdd\u5b58",iconCls:"icon-ok",handler:function(){$("#monitorConfigForm").submit()}},{text:"\u53d6\u6d88",iconCls:"icon-cancel",handler:function(){monitorConfig.panel("close")}}]})}
function editConfigForm(){var a=$("#dataSynchronizeList").datagrid("getChecked");0==a.length?parent.$.messager.show({title:"\u63d0\u793a",msg:"\u8bf7\u5148\u9009\u62e9\u4e00\u884c\u6570\u636e\uff01",position:"bottomRight"}):1<a.length?parent.$.messager.show({title:"\u63d0\u793a",msg:"\u8bf7\u9009\u62e9\u4e00\u884c\u6570\u636e\uff01",position:"bottomRight"}):(a=a[0].id,dataSynchronize=$("#dlgg").dialog({title:"\u4fee\u6539",width:585,height:450,href:baseUrl+"/dataSynchronize/editDataSynchronizeForm/"+
a,maximizable:!0,modal:!0,buttons:[{text:"\u4fdd\u5b58",iconCls:"icon-ok",handler:function(){addOrUpdateDataSynchronize()}},{text:"\u53d6\u6d88",iconCls:"icon-cancel",handler:function(){dataSynchronize.panel("close")}}]}))}
function editDataSynchronizeOne(a){dataSynchronize=$("#dlgg").dialog({title:"\u4fee\u6539",width:585,height:450,href:baseUrl+"/dataSynchronize/editDataSynchronizeForm/"+a,maximizable:!0,modal:!0,buttons:[{text:"\u4fdd\u5b58",iconCls:"icon-ok",handler:function(){addOrUpdateDataSynchronize()}},{text:"\u53d6\u6d88",iconCls:"icon-cancel",handler:function(){dataSynchronize.panel("close")}}]})}
function deleteConfig(){var a=$("#dataSynchronizeList").datagrid("getChecked"),b=a.length;if(0>=$("#dataSynchronizeList").datagrid("getData").total-b)$.messager.show({title:"\u63d0\u793a",msg:"\u5fc5\u987b\u4fdd\u7559\u4e00\u884c\u914d\u7f6e\u4fe1\u606f\uff01",position:"bottomRight"});else if(0==a.length)$.messager.show({title:"\u63d0\u793a",msg:"\u8bf7\u5148\u9009\u62e9\u4e00\u884c\u6570\u636e\uff01",position:"bottomRight"});else{var c=[];$.each(a,function(b,a){c.push(a.id)});$.easyui.messager.confirm("\u64cd\u4f5c\u63d0\u793a",
"\u60a8\u786e\u5b9a\u8981\u5220\u9664"+b+"\u884c\u6570\u636e\u5417\uff1f",function(a){a&&$.ajax({type:"POST",contentType:"application/json;charset=utf-8",url:baseUrl+"/dataSynchronize/deleteDataSynchronize",data:JSON.stringify({ids:c}),datatype:"json",success:function(a){"success"==a.status?($("#dataSynchronizeList").datagrid("reload"),$("#dataSynchronizeList").datagrid("clearSelections").datagrid("clearChecked"),$.messager.show({title:"\u63d0\u793a",msg:"\u5220\u9664\u6210\u529f\uff01",position:"bottomRight"})):
$.messager.show({title:"\u63d0\u793a",msg:a.mess,position:"bottomRight"})}})})}}
function copyDataSynchronize(){var a=$("#dataSynchronizeList").datagrid("getChecked");$("#dataSynchronizeList").datagrid("getData");if(0==a.length)$.messager.show({title:"\u63d0\u793a",msg:"\u8bf7\u5148\u9009\u62e9\u4e00\u884c\u6570\u636e\uff01",position:"bottomRight"});else{var b=[];$.each(a,function(a,d){b.push(d.id)});$.ajax({type:"POST",contentType:"application/json;charset=utf-8",url:baseUrl+"/dataSynchronize/copyDataSynchronize",data:JSON.stringify({ids:b}),datatype:"json",success:function(a){"success"==
a.status&&($("#dataSynchronizeList").datagrid("reload"),$("#dataSynchronizeList").datagrid("clearSelections").datagrid("clearChecked"));$.messager.show({title:"\u63d0\u793a",msg:a.mess,position:"bottomRight"})}})}}
function startDataTask(){var a=$("#dataSynchronizeList").datagrid("getChecked");$("#dataSynchronizeList").datagrid("getData");if(0==a.length)$.messager.show({title:"\u63d0\u793a",msg:"\u8bf7\u9009\u62e9\u4e00\u884c\u6570\u636e\uff01",position:"bottomRight"});else{var b=[];$.each(a,function(a,d){b.push(d.id)});$.ajax({type:"POST",contentType:"application/json;charset=utf-8",url:baseUrl+"/dataSynchronize/startDataTask",data:JSON.stringify({ids:b}),datatype:"json",success:function(a){"success"==a.status&&
($("#dataSynchronizeList").datagrid("reload"),$("#dataSynchronizeList").datagrid("clearSelections").datagrid("clearChecked"));$.messager.show({title:"\u63d0\u793a",msg:a.mess,position:"bottomRight"})}})}}
function startDataTaskOne(){var a=$("#dataSynchronizeList").datagrid("getChecked");$("#dataSynchronizeList").datagrid("getData");if(0==a.length)$.messager.show({title:"\u63d0\u793a",msg:"\u8bf7\u9009\u62e9\u4e00\u884c\u6570\u636e\uff01",position:"bottomRight"});else{var b=!1,c=[];$.each(a,function(a,e){c.push(e.id);if("1"==e.status)return $.messager.show({title:"\u63d0\u793a",msg:"\u8fd0\u884c\u4e2d\u7684\u4efb\u52a1\u65e0\u6cd5\u6267\u884c\u8be5\u64cd\u4f5c\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u770b\u770b\uff01",
position:"bottomRight"}),b=!0,!1});b||$.ajax({type:"POST",contentType:"application/json;charset=utf-8",url:baseUrl+"/dataSynchronize/startDataTaskOne",data:JSON.stringify({ids:c}),datatype:"json",success:function(a){"success"==a.status&&($("#dataSynchronizeList").datagrid("reload"),$("#dataSynchronizeList").datagrid("clearSelections").datagrid("clearChecked"));$.messager.show({title:"\u63d0\u793a",msg:a.mess,position:"bottomRight"})}})}}
function stopDataTask(){var a=$("#dataSynchronizeList").datagrid("getChecked");$("#dataSynchronizeList").datagrid("getData");if(0==a.length)parent.$.messager.show({title:"\u63d0\u793a",msg:"\u8bf7\u9009\u62e9\u4e00\u884c\u6570\u636e\uff01",position:"bottomRight"});else{var b=[];$.each(a,function(a,d){b.push(d.id)});$.ajax({type:"POST",contentType:"application/json;charset=utf-8",url:baseUrl+"/dataSynchronize/stopDataTask",data:JSON.stringify({ids:b}),datatype:"json",success:function(a){"success"==
a.status&&($("#dataSynchronizeList").datagrid("reload"),$("#dataSynchronizeList").datagrid("clearSelections").datagrid("clearChecked"));$.messager.show({title:"\u63d0\u793a",msg:a.mess,position:"bottomRight"})}})}}
function batchStartSynchronize(){var a=$("#dataSynchronizeList").datagrid("getChecked");$("#dataSynchronizeList").datagrid("getData");if(0==a.length)parent.$.messager.show({title:"\u63d0\u793a",msg:"\u8bf7\u5148\u9009\u62e9\u4e00\u884c\u6570\u636e\uff01",position:"bottomRight"});else{var b=[];$.each(a,function(a,d){b.push(d.id)});$.easyui.messager.confirm("\u64cd\u4f5c\u63d0\u793a","\u60a8\u786e\u5b9a\u8981\u542f\u7528\u5417\uff1f",function(a){a&&$.ajax({type:"POST",contentType:"application/json;charset=utf-8",
url:baseUrl+"/dataSynchronize/batchStartSynchronize",data:JSON.stringify({ids:b}),datatype:"json",success:function(a){"success"==a.status?($("#dataSynchronizeList").datagrid("reload"),$.messager.show({title:"\u63d0\u793a",msg:a.mess,position:"bottomRight"})):$.messager.show({title:"\u63d0\u793a",msg:a.mess,position:"bottomRight",icon:"warning"})}})})}}
function batchBlockSynchronize(){var a=$("#dataSynchronizeList").datagrid("getChecked");$("#dataSynchronizeList").datagrid("getData");if(0==a.length)parent.$.messager.show({title:"\u63d0\u793a",msg:"\u8bf7\u5148\u9009\u62e9\u4e00\u884c\u6570\u636e\uff01",position:"bottomRight"});else{var b=[];$.each(a,function(a,d){b.push(d.id)});$.easyui.messager.confirm("\u64cd\u4f5c\u63d0\u793a","\u60a8\u786e\u5b9a\u8981\u505c\u7528\u5417\uff1f",function(a){a&&$.ajax({type:"POST",contentType:"application/json;charset=utf-8",
url:baseUrl+"/dataSynchronize/batchBlockSynchronize",data:JSON.stringify({ids:b}),datatype:"json",success:function(a){"success"==a.status&&($("#dataSynchronizeList").datagrid("reload"),$("#dataSynchronizeList").datagrid("clearSelections").datagrid("clearChecked"));$.messager.show({title:"\u63d0\u793a",msg:a.mess,position:"bottomRight"})}})})}}function refresh11(){$("#dataSynchronizeList").datagrid("reload");$("#dataSynchronizeList").datagrid("clearSelections").datagrid("clearChecked")}
function viewLog(a){dataSynchronizeLog=$("#dlgg2").dialog({title:"\u65e5\u5fd7\u67e5\u770b",width:750,height:480,href:baseUrl+"/dataSynchronize/dataSynchronizeLogForm/"+a,maximizable:!0,modal:!0,buttons:[{text:"\u53d6\u6d88",iconCls:"icon-cancel",handler:function(){dataSynchronizeLog.panel("close")}}]})};
